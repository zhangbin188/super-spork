import{connect as $_0x4d2a}from'cloudflare:sockets';let $_0x29a7='4f1b9a56-a2bd-4f6f-9162-9b5506dda207';let $_0x4b82='tp50000.kr.proxyip.fgfw.eu.org';const $_0x325c=true;const $_0x2e59=350;const $_0x272b=65536;const $_0x3e64=0;const $_0x20f3=0;const $_0x3045=true;const $_0x1e0c=['store.ubi.com','ip.sb','mfa.gov.ua','shopify.com','cloudflare-dl.byoip.top','staticdelivery.nexusmods.com','bestcf.top','cf.090227.xyz','cf.zhetengsha.eu.org','baipiao.cmliussss.abrdns.com','saas.sin.fan'];let $_0x4755={$_0x1f5c:'',$_0x2640:null};function $_0x3f99($_0x418f){$_0x4755={$_0x1f5c:'',$_0x2640:null};if(!$_0x418f)return;const $_0x2995=$_0x418f.split(':');$_0x4755.$_0x1f5c=$_0x2995[0].trim();if($_0x2995.length>1){const $_0x48f8=parseInt($_0x2995[1].trim(),10);if(!isNaN($_0x48f8)&&$_0x48f8>0&&$_0x48f8<=65535)$_0x4755.$_0x2640=$_0x48f8}}function $_0x245d($_0x39f5){const $_0x2d8e=/^\/proxy=([^/]+)(?:\/.*)?$/.exec($_0x39f5);return $_0x2d8e?$_0x2d8e[1]:null}function $_0x39e9($_0x2207){const $_0x31f8=($_0x2207.searchParams.get('proxy')||'').trim();const $_0x2f9d=$_0x245d($_0x2207.pathname);return $_0x31f8||$_0x2f9d||$_0x4b82}function $_0x32b3(...$_0x3559){const $_0x3d9c=$_0x3559.reduce(($_0x49e8,$_0x2a81)=>$_0x49e8+$_0x2a81.byteLength,0);const $_0x1b1c=new Uint8Array($_0x3d9c);let $_0x354d=0;for(const $_0x2d58 of $_0x3559){$_0x1b1c.set(new Uint8Array($_0x2d58),$_0x354d);$_0x354d+=$_0x2d58.byteLength}return $_0x1b1c.buffer}function $_0x29f5($_0x14f5){if(!$_0x14f5)return{error:null};try{const $_0x1454=$_0x14f5.replace(/-/g,'+').replace(/_/g,'/');const $_0x4a8e=atob($_0x1454);const $_0x1306=Uint8Array.from($_0x4a8e,($_0x34b1)=>$_0x34b1.charCodeAt(0));return{earlyData:$_0x1306.buffer,error:null}}catch($_0x36f1){return{error:$_0x36f1}}}const $_0x3f5c=new TextDecoder();function $_0x31e7($_0x1650){const $_0x327e=/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;return $_0x327e.test($_0x1650)}const $_0x1f9c=[];for(let $_0x1f56=0;$_0x1f56<256;++$_0x1f56)$_0x1f9c.push(($_0x1f56+256).toString(16).slice(1));function $_0x2d35($_0x271b,$_0x31e3=0){return $_0x1f9c[$_0x271b[$_0x31e3+0]]+$_0x1f9c[$_0x271b[$_0x31e3+1]]+$_0x1f9c[$_0x271b[$_0x31e3+2]]+$_0x1f9c[$_0x271b[$_0x31e3+3]]+"-"+$_0x1f9c[$_0x271b[$_0x31e3+4]]+$_0x1f9c[$_0x271b[$_0x31e3+5]]+"-"+$_0x1f9c[$_0x271b[$_0x31e3+6]]+$_0x1f9c[$_0x271b[$_0x31e3+7]]+"-"+$_0x1f9c[$_0x271b[$_0x31e3+8]]+$_0x1f9c[$_0x271b[$_0x31e3+9]]+"-"+$_0x1f9c[$_0x271b[$_0x31e3+10]]+$_0x1f9c[$_0x271b[$_0x31e3+11]]+$_0x1f9c[$_0x271b[$_0x31e3+12]]+$_0x1f9c[$_0x271b[$_0x31e3+13]]+$_0x1f9c[$_0x271b[$_0x31e3+14]]+$_0x1f9c[$_0x271b[$_0x31e3+15]].toLowerCase()}function $_0x177b($_0x34f8,$_0x1a9b=0){const $_0x255d=$_0x2d35($_0x34f8,$_0x1a9b);if(!$_0x31e7($_0x255d))throw TypeError('Invalid UUID');return $_0x255d}function $_0x149d($_0x3600,$_0x1e8b,$_0x259e){const $_0x3e10=atob(atob('ZG14bGMzTT0='));const $_0x3e5a=`/proxy=${$_0x259e}`;const $_0x1d55=new URLSearchParams({encryption:'none',network:'ws',type:'none',host:$_0x1e8b,path:$_0x3e5a});return btoa($_0x1e0c.map(($_0x1d36,$_0x2e90)=>{const $_0x360f=`T-SNIP_${String($_0x2e90+1).padStart(2,'0')}`;return`${$_0x3e10}://${$_0x3600}@${$_0x1d36}:8080?${$_0x1d55.toString()}#${$_0x360f}`}).join('\n')).replace(/\+/g,'-').replace(/\//g,'_')}if(!$_0x31e7($_0x29a7)){throw new Error('Invalid UUID')}export default{async fetch($_0x17c5){try{const $_0x3627=new URL($_0x17c5.url);const $_0x129c=$_0x39e9($_0x3627);$_0x3f99($_0x129c);let $_0x3697=null;const $_0x171e=/^\/proxy=([^/]+)(?:\/([0-9a-f-]{36}))?$/.exec($_0x3627.pathname);if($_0x171e&&$_0x171e[2]){$_0x3697=$_0x171e[2]}else if($_0x3627.pathname.length>1){$_0x3697=$_0x3627.pathname.substring(1)}const $_0x2f06=$_0x17c5.headers.get('Upgrade');if(!$_0x2f06||$_0x2f06!=='websocket'){if($_0x3627.pathname==='/'){return new Response('Success',{status:200,headers:{'Content-Type':'text/plain;charset=utf-8'}})}if($_0x3697&&$_0x3697===$_0x29a7){const $_0x2250=$_0x149d($_0x3697,$_0x17c5.headers.get('Host'),$_0x129c);return new Response($_0x2250,{status:200,headers:{'Content-Type':'text/plain;charset=utf-8'}})}return new Response('Invalid UUID',{status:400,headers:{'Content-Type':'text/plain;charset=utf-8'}})}return await $_0x17e5($_0x17c5)}catch($_0x251d){return new Response($_0x251d.toString(),{status:500,headers:{'Content-Type':'text/plain;charset=utf-8'}})}}};async function $_0x17e5($_0x35e8){const $_0x376c=new URL($_0x35e8.url);const $_0x366c=$_0x39e9($_0x376c);$_0x3f99($_0x366c);const $_0x396c=new WebSocketPair();const[$_0x1f69,$_0x367e]=Object.values($_0x396c);$_0x367e.accept();const $_0x13e1=$_0x35e8.headers.get('sec-websocket-protocol')||'';const $_0x289e=$_0x1a7e($_0x367e,$_0x13e1);const $_0x37f5={value:null,writer:null,ready:false,started:false,earlyBuf:[],earlyBytes:0};let $_0x2109=null;let $_0x1260=false;$_0x367e.addEventListener('close',()=>{try{$_0x37f5.value&&$_0x37f5.value.close()}catch{}});$_0x367e.addEventListener('error',()=>{try{$_0x37f5.value&&$_0x37f5.value.close()}catch{}});$_0x289e.pipeTo(new WritableStream({async write($_0x3a25){if($_0x1260&&$_0x2109){$_0x2109($_0x3a25);return}if($_0x37f5.ready&&$_0x37f5.writer){await $_0x37f5.writer.write($_0x3a25);return}if(!$_0x37f5.started){const{$_0x3a5b,$_0x2e3a,$_0x375b=443,$_0x2d26='',$_0x1920,$_0x1f26=new Uint8Array([0,0]),$_0x21f3}=$_0x12e0($_0x3a25,$_0x29a7);if($_0x3a5b)throw new Error($_0x2e3a);if($_0x21f3){if($_0x375b===53){$_0x1260=true}else{throw new Error('UDP only allowed for DNS (port 53)')}}const $_0x33b2=new Uint8Array([$_0x1f26[0],0]);const $_0x343d=$_0x3a25.slice($_0x1920);if($_0x1260){const{$_0x11f7}=await $_0x217d($_0x367e,$_0x33b2);$_0x2109=$_0x11f7;$_0x2109($_0x343d);$_0x37f5.started=true;return}$_0x291b($_0x37f5,$_0x2d26,$_0x375b,$_0x343d,$_0x367e,$_0x33b2);$_0x37f5.started=true;return}if($_0x37f5.earlyBytes+$_0x3a25.byteLength<=$_0x272b){$_0x37f5.earlyBuf.push($_0x3a25);$_0x37f5.earlyBytes+=$_0x3a25.byteLength}else if($_0x37f5.writer){await $_0x37f5.writer.write($_0x3a25)}}})).catch(()=>{});return new Response(null,{status:101,webSocket:$_0x1f69})}function $_0x1a7e($_0x11e8,$_0x33e1){let $_0x17f0=false;const{$_0x342d}=$_0x29f5($_0x33e1);return new ReadableStream({start($_0x3070){if($_0x342d)$_0x3070.enqueue(new Uint8Array($_0x342d));$_0x11e8.addEventListener('message',($_0x24b0)=>{if(!$_0x17f0)$_0x3070.enqueue($_0x24b0.data)});$_0x11e8.addEventListener('close',()=>{$_0x2126($_0x11e8);if(!$_0x17f0)$_0x3070.close()});$_0x11e8.addEventListener('error',($_0x3557)=>$_0x3070.error($_0x3557))},cancel(){$_0x17f0=true;$_0x2126($_0x11e8)}})}function $_0x12e0($_0x349c,$_0x21e7){try{if($_0x349c.byteLength<24)throw new Error('Invalid data');const $_0x23f0=new Uint8Array($_0x349c.slice(0,1));const $_0x1f50=$_0x177b(new Uint8Array($_0x349c.slice(1,17))).toLowerCase();if($_0x1f50!==$_0x21e7.toLowerCase())throw new Error('Invalid user');const $_0x3196=new Uint8Array($_0x349c.slice(17,18))[0];const $_0x3976=18+$_0x3196;const $_0x32f5=new Uint8Array($_0x349c.slice($_0x3976,$_0x3976+1))[0];const $_0x395a=$_0x32f5===2;if($_0x32f5!==1&&!$_0x395a)throw new Error(`Unsupported command ${$_0x32f5}`);const $_0x272e=$_0x3976+1;if($_0x349c.byteLength<$_0x272e+2)throw new Error('Missing port');const $_0x2d65=new DataView($_0x349c.slice($_0x272e,$_0x272e+2)).getUint16(0);let $_0x2e77=$_0x272e+2;if($_0x349c.byteLength<$_0x2e77+1)throw new Error('Missing address type');const $_0x32b7=new Uint8Array($_0x349c.slice($_0x2e77,$_0x2e77+1))[0];$_0x2e77+=1;let $_0x25f9='',$_0x3930=0;switch($_0x32b7){case 1:$_0x3930=4;if($_0x349c.byteLength<$_0x2e77+$_0x3930)throw new Error('Incomplete IPv4');$_0x25f9=new Uint8Array($_0x349c.slice($_0x2e77,$_0x2e77+$_0x3930)).join('.');break;case 2:$_0x3930=new Uint8Array($_0x349c.slice($_0x2e77,$_0x2e77+1))[0];$_0x2e77+=1;if($_0x349c.byteLength<$_0x2e77+$_0x3930)throw new Error('Incomplete domain');$_0x25f9=$_0x3f5c.decode($_0x349c.slice($_0x2e77,$_0x2e77+$_0x3930));break;case 3:$_0x3930=16;if($_0x349c.byteLength<$_0x2e77+$_0x3930)throw new Error('Incomplete IPv6');const $_0x2e54=new DataView($_0x349c.slice($_0x2e77,$_0x2e77+$_0x3930));const $_0x1847=[];for(let $_0x1771=0;$_0x1771<8;$_0x1771++)$_0x1847.push($_0x2e54.getUint16($_0x1771*2).toString(16));$_0x25f9=$_0x1847.join(':');break;default:throw new Error(`Invalid address type ${$_0x32b7}`)}const $_0x2d71=$_0x2e77+$_0x3930;return{hasError:false,addressRemote:$_0x25f9,portRemote:$_0x2d65,rawDataIndex:$_0x2d71,protoVersion:$_0x23f0,isUDP:$_0x395a}}catch($_0x3766){return{hasError:true,message:$_0x3766.message}}}function $_0x376e($_0x329c,$_0x26f2,$_0x31e2){const{$_0x2f8e=false,$_0x317e=0,$_0x349a=0}=$_0x31e2||{};let $_0x3717=!!$_0x2f8e;let $_0x2957=[];let $_0x27f8=0;let $_0x2595=null;let $_0x191c=false;function $_0x2e27(){if(!$_0x3717){$_0x329c.send($_0x26f2);$_0x3717=true}}function $_0x120c(){if($_0x191c)return;if(!$_0x3717)$_0x2e27();if($_0x27f8===0)return;const $_0x331e=new Uint8Array($_0x27f8);let $_0x1f95=0;for(const $_0x27f1 of $_0x2957){const $_0x1e9e=$_0x27f1 instanceof Uint8Array?$_0x27f1:new Uint8Array($_0x27f1);$_0x331e.set($_0x1e9e,$_0x1f95);$_0x1f95+=$_0x1e9e.byteLength}$_0x2957.length=0;$_0x27f8=0;$_0x329c.send($_0x331e)}function $_0x35f9(){if($_0x2595||$_0x317e<=0)return;$_0x2595=setTimeout(()=>{$_0x2595=null;$_0x120c()},$_0x317e)}return{push($_0x15e7){if($_0x191c)return;if(!$_0x317e||!$_0x349a){if(!$_0x3717)$_0x2e27();$_0x329c.send($_0x15e7);return}const $_0x216c=$_0x15e7 instanceof Uint8Array?$_0x15e7:new Uint8Array($_0x15e7);$_0x2957.push($_0x216c);$_0x27f8+=$_0x216c.byteLength;if($_0x27f8>=$_0x349a){$_0x120c()}else{$_0x35f9()}},flush(){if($_0x2595){try{clearTimeout($_0x2595)}catch{}$_0x2595=null}$_0x120c()},markHeaderSent(){$_0x3717=true},close(){if($_0x2595){try{clearTimeout($_0x2595)}catch{}$_0x2595=null}$_0x191c=true;$_0x2957.length=0;$_0x27f8=0}}}async function $_0x291b($_0x387a,$_0x3041,$_0x15b6,$_0x2558,$_0x384c,$_0x282a){if($_0x387a._active)return;$_0x387a._active=true;const $_0x1550=$_0x325c&&$_0x4755.$_0x1f5c?$_0x2e59:null;let $_0x1d8a=null;let $_0x20f8=null;let $_0x265d=null;let $_0x1259=null;let $_0x216a=false;let $_0x3257=false;const $_0x396e=$_0x376e($_0x384c,$_0x282a,{headerAlreadySent:false,coalesceMs:$_0x3e64,maxBytes:$_0x20f3});function $_0x239a(){if($_0x1259){try{clearTimeout($_0x1259)}catch{}$_0x1259=null}}async function $_0x2e36($_0x2175,$_0x14b5){$_0x1d8a=$_0x14b5;$_0x239a();try{if($_0x14b5==='direct'&&$_0x265d)$_0x265d.close()}catch{}try{if($_0x14b5==='proxy'&&$_0x20f8)$_0x20f8.close()}catch{}$_0x387a.value=$_0x2175;$_0x387a.writer=$_0x2175.writable.getWriter();if($_0x387a.earlyBuf.length){for(const $_0x386a of $_0x387a.earlyBuf){await $_0x387a.writer.write($_0x386a)}$_0x387a.earlyBuf.length=0;$_0x387a.earlyBytes=0}$_0x387a.ready=true}async function $_0x339e($_0x32f3,$_0x3364){const $_0x3552=$_0x32f3.readable.getReader();try{let $_0x19b3=true;while(true){const{$_0x34f0,$_0x192a}=await $_0x3552.read();if($_0x192a)break;if($_0x216a)break;if(!$_0x1d8a)await $_0x2e36($_0x32f3,$_0x3364);if($_0x19b3){if($_0x3045&&!$_0x3257&&$_0x384c.readyState===1){$_0x396e.push(new Uint8Array(0));$_0x3257=true}$_0x19b3=false}$_0x396e.push($_0x34f0)}}catch{}finally{try{$_0x3552.releaseLock()}catch{}if(!$_0x216a&&$_0x1d8a===$_0x3364){try{$_0x396e.flush()}catch{}$_0x216a=true;$_0x2126($_0x384c);$_0x396e.close()}}}$_0x20f8=$_0x4d2a({hostname:$_0x3041,port:$_0x15b6});try{const $_0x17f9=$_0x20f8.writable.getWriter();await $_0x17f9.write($_0x2558);$_0x17f9.releaseLock();if($_0x3045&&!$_0x3257&&$_0x384c.readyState===1){$_0x396e.push(new Uint8Array(0));$_0x3257=true}}catch{}$_0x339e($_0x20f8,'direct');if($_0x1550!==null){const $_0x19b7=async()=>{if($_0x1d8a||$_0x216a)return;try{$_0x265d=$_0x4d2a({hostname:$_0x4755.$_0x1f5c,port:$_0x4755.$_0x2640!==null?$_0x4755.$_0x2640:$_0x15b6});const $_0x3921=$_0x265d.writable.getWriter();await $_0x3921.write($_0x2558);$_0x3921.releaseLock();if($_0x3045&&!$_0x3257&&$_0x384c.readyState===1){$_0x396e.push(new Uint8Array(0));$_0x3257=true}$_0x339e($_0x265d,'proxy')}catch{}};if($_0x1550<=0){$_0x19b7()}else{$_0x1259=setTimeout($_0x19b7,$_0x1550)}}}}async function $_0x217d($_0x20e7,$_0x380c){let $_0x1f7e=false;const $_0x34e2=new TransformStream({transform($_0x326f,$_0x15f2){for(let $_0x156c=0;$_0x156c<$_0x326f.byteLength;){const $_0x394a=new DataView($_0x326f.buffer,$_0x326f.byteOffset+$_0x156c,2).getUint16(0);const $_0x3558=new Uint8Array($_0x326f.buffer,$_0x326f.byteOffset+$_0x156c+2,$_0x394a);$_0x15f2.enqueue($_0x3558);$_0x156c+=2+$_0x394a}}});$_0x34e2.readable.pipeTo(new WritableStream({async write($_0x3729){const $_0x2098=await fetch('https://dns.google/dns-query',{method:'POST',headers:{'Content-Type':'application/dns-message','Accept':'application/dns-message'},body:$_0x3729});const $_0x2599=await $_0x2098.arrayBuffer();const $_0x324c=$_0x2599.byteLength;const $_0x3555=new Uint8Array([($_0x324c>>8)&0xff,$_0x324c&0xff]);if($_0x20e7.readyState===1){if(!$_0x1f7e){$_0x20e7.send($_0x380c);$_0x1f7e=true}$_0x20e7.send($_0x3555);$_0x20e7.send($_0x2599)}}})) .catch(()=>{});const $_0x3037=$_0x34e2.writable.getWriter();return{write($_0x2e10){$_0x3037.write($_0x2e10)}}}function $_0x2126($_0x3550){try{if($_0x3550.readyState===1||$_0x3550.readyState===2){$_0x3550.close()}}catch{}}
